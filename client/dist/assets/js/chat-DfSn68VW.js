import{h as s}from"./index-DqO_OEbo.js";import{V as i}from"./vue-vendor-Zc8KthId.js";async function c(t){return s.post("/api/chat/create",t)}async function o(t){return s.post("/api/chat/update",t)}async function n(t){return s.post(`/api/chat/remove/${t}`)}const h=async()=>s.post("/api/chat/clear");async function r(t){return s.get(`/api/chat/${t}`)}async function p(){return s.post("/api/chat/list")}async function u(t){return s.post("/api/chat/message/create",t)}async function m(t){return s.post("/api/chat/message/update",t)}async function f(t){return s.post("/api/prompt/create",t)}async function y(t){return s.post(`/api/prompt/remove/${t}`)}async function C(t){return s.post("/api/prompt/update",t)}async function d(){return s.post("/api/prompt/list")}const l=i("chat-store",{state:()=>({showSidebar:!0,showPromptSidebar:!1,activeId:"",chatList:[],chat:null,promptList:[],prompt:"",searchPromptList:[]}),actions:{async createChat(t){try{const a=await c(t);this.chat=a.data,this.activeId=a.data.chatId,await this.queryChatList()}catch(a){throw new Error("创建对话失败",a.message)}},async removeChat(t){await n(t),this.queryChatList()},async updateChat(t){await o(t),this.queryChatList()},async clearChatList(){await h(),this.chatList=[],this.chat=null,this.activeId=void 0},async queryChatList(){const t=await p();try{const a=t.data||[];this.chatList=a}catch(a){throw new Error("查询对话列表失败",a.message)}},async setActive(t){if(this.activeId!==t){const a=await r(t);this.chat=a.data,this.activeId=t}},async createMessage(t){const a=await u(t);return await this.queryMessage(t.chatId),a.data},async updateMessage(t){try{await m(t),await this.queryMessage(t.chatId)}catch(a){throw new Error("更新消息失败",a.message)}},async queryMessage(t){const a=await r(t);return this.chat=a.data,a.data},async getPromptList(){const t=await d();return this.promptList=t.data.length>0?t.data:[],this.promptList},async removePrompt(t){await y(t),await this.getPromptList()},searchPrompts(t){if(!t.trim()){this.searchPromptList=this.promptList;return}const a=t.toLowerCase();this.searchPromptList=this.promptList.filter(e=>e.title.toLowerCase().includes(a)||e.content.toLowerCase().includes(a))}}});export{C as a,f as c,l as u};
