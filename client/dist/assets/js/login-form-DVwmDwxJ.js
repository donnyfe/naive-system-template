import{E as Y,W as w,X as _,Y as u,k as L,r as f,Z as I,a3 as R,U as e,_ as a,j as v,e as K,o as M,$ as g,Q as n,ae as O,H as T}from"./vue-vendor-Zc8KthId.js";import{u as J,U as W}from"./hooks-B211TLK2.js";import{u as Z,c as Q,l as B,b as X}from"./index-DqO_OEbo.js";import{g as q,j as G}from"./utils-vendor-lGwZSMVs.js";import{r as ee}from"./libs-vendor-D1R-aMUW.js";import{U as te,Z as oe,a0 as se,V as ae,W as ne,m as le,N as re,a1 as ce,B as ie}from"./ui-vendor-D13i6_Ys.js";import{L as pe}from"./LockOutlined-v1xK1X82.js";var ue=ee();const l=q(ue),N=l.enc.Utf8.parse("AOWQ4P0YEC4YXUKS"),V=l.enc.Utf8.parse("O3V2GCL1K2HNZ9Y7");function H(d){const r=l.enc.Utf8.parse(d);return l.AES.encrypt(r,N,{iv:V,mode:l.mode.CBC,padding:l.pad.Pkcs7}).ciphertext.toString().toUpperCase()}function de(d){const r=l.enc.Hex.parse(d),i=l.enc.Base64.stringify(r);return l.AES.decrypt(i,N,{iv:V,mode:l.mode.CBC,padding:l.pad.Pkcs7}).toString(l.enc.Utf8).toString()}const me={style:{display:"inline-block"},viewBox:"0 0 48 48",width:"1.2em",height:"1.2em"};function _e(d,r){return _(),w("svg",me,r[0]||(r[0]=[u("g",{fill:"none"},[u("path",{fill:"currentColor",d:"M44 23.994a2 2 0 0 0-4 0zm-20-16a2 2 0 1 0 0-4zm15 32H9v4h30zm-31-1v-30H4v30zm32-15v15h4v-15zm-31-16h15v-4H9zm0 32a1 1 0 0 1-1-1H4a5 5 0 0 0 5 5zm30 4a5 5 0 0 0 5-5h-4a1 1 0 0 1-1 1zm-31-35a1 1 0 0 1 1-1v-4a5 5 0 0 0-5 5z"}),u("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"4",d:"m6 35l10.693-9.802a2 2 0 0 1 2.653-.044L32 36m-4-5l4.773-4.773a2 2 0 0 1 2.615-.186L42 31M33 7l8 8m0-8l-8 8"})],-1)]))}const fe=Y({name:"icon-park-outline-error-picture",render:_e}),he={class:"relative overflow-hidden"},ge=["src","alt"],ve={key:2,class:"w-full h-full flex-row flex-center bg-#f0f0f0 select-none"},we=L({__name:"fallback-image",props:{src:{},alt:{},class:{}},setup(d){const r=f(!1),i=f(!0);function c(){i.value=!1}function x(){r.value=!0,i.value=!1}return(h,m)=>{const s=te,U=fe,k=oe;return _(),w("div",he,[i.value?(_(),I(s,{key:0,size:"small"})):R("",!0),r.value?(_(),w("div",ve,[e(U,{class:"text-20px mr-2 text-dark"}),e(k,{class:"text-12px mt-4px text-dark"},{default:a(()=>m[0]||(m[0]=[v(" 加载失败 ")])),_:1})])):(_(),w("img",{key:1,src:h.src,alt:h.alt,onLoad:c,onError:x,class:"w-full h-full block"},null,40,ge))])}}}),xe={class:"login-form login-modal-form"},ke={class:"w-full h-full flex flex-row justify-between items-center"},ye={class:"w-28 h-full items-center ml-4"},Ce={class:"flex justify-between mb-4 text-white flex-center"},be={class:"text-white"},Ue={class:"mt-4 text-center text-white"},Se=L({__name:"login-form",emits:["update:modelValue"],setup(d,{emit:r}){const i=r,{t:c}=Z(),x=Q(),h=f(),m=f(!1),s=K({email:"",password:"",captcha:""}),U=J(s),k=f(""),D="",y=G(()=>{k.value=`${D}/api/auth/captcha?${Date.now()}`},500),C=f(!1);async function $(){try{await h.value?.validate(),m.value=!0;const{email:t,password:o}=s;if(C.value&&t&&o){const b=H(o);B.set("loginAccount",{email:t,password:b,timestamp:Date.now()})}(await x.login({email:t,password:H(o),captcha:s.captcha})).success||y()}catch{y()}finally{m.value=!1}}function P(t){i("update:modelValue",t)}return M(()=>{y();const t=B.get("loginAccount");t?.email&&t?.password&&(t?.timestamp&&Date.now()-t.timestamp>6048e5||(s.email=t.email,s.password=de(t.password),C.value=!0))}),(t,o)=>{const S=se,b=re,z=le,E=ne,j=ce,A=ie,F=ae;return _(),w("div",xe,[e(S,{class:"form-title"},{default:a(()=>[v(g(t.$t("login.signInTitle")),1)]),_:1}),e(F,{ref_key:"formRef",ref:h,model:s,rules:n(U),size:"large"},{default:a(()=>[e(E,{path:"email"},{default:a(()=>[e(z,{value:s.email,"onUpdate:value":o[0]||(o[0]=p=>s.email=p),autocomplete:"email",clearable:"",placeholder:n(c)("login.emailPlaceholder")},{prefix:a(()=>[e(b,null,{default:a(()=>[e(n(W))]),_:1})]),_:1},8,["value","placeholder"])]),_:1}),e(E,{path:"password"},{default:a(()=>[e(z,{value:s.password,"onUpdate:value":o[1]||(o[1]=p=>s.password=p),type:"password",autocomplete:"current-password","show-password-on":"click",clearable:"",placeholder:n(c)("login.passwordPlaceholder")},{prefix:a(()=>[e(b,null,{default:a(()=>[e(n(pe))]),_:1})]),_:1},8,["value","placeholder"])]),_:1}),e(E,{path:"captcha"},{default:a(()=>[u("div",ke,[e(z,{class:"flex-1",value:s.captcha,"onUpdate:value":o[2]||(o[2]=p=>s.captcha=p),clearable:"",placeholder:n(c)("login.captchaPlaceholder"),onKeyup:O($,["enter"])},null,8,["value","placeholder"]),u("div",ye,[e(we,{class:"w-full h-full max-h-44px rounded cursor-pointer",src:k.value,alt:n(c)("login.captcha"),onClick:n(y)},null,8,["src","alt","onClick"])])])]),_:1}),u("div",Ce,[e(j,{checked:C.value,"onUpdate:checked":o[3]||(o[3]=p=>C.value=p)},{default:a(()=>[u("span",be,g(n(c)("login.rememberMe")),1)]),_:1},8,["checked"])]),e(A,{class:"text-white rounded-lg",block:"",type:"primary",size:"large",loading:m.value,onClick:$},{default:a(()=>[v(g(n(c)("login.signIn")),1)]),_:1},8,["loading"]),u("div",Ue,[v(g(n(c)("login.noAccountText"))+" ",1),e(A,{text:"",class:T(["text-[var(--n-text-color-pressed)]"]),onClick:o[4]||(o[4]=p=>P("registerForm"))},{default:a(()=>[v(g(n(c)("login.signUp")),1)]),_:1})])]),_:1},8,["model","rules"])])}}}),Ne=X(Se,[["__scopeId","data-v-91cdae8e"]]);export{Ne as default};
