import{k as F,W as p,X as d,Y as r,r as h,c as W,w as G,o as H,H as b,Q as o,$ as m,U as e,_ as s,j as y,F as B,ae as X,O as Y,a4 as J}from"./vue-vendor-Zc8KthId.js";import{u as Z,a as ee,c as te}from"./chat-DfSn68VW.js";import{G as oe,B as se,N as ae,V as le,W as ne,m as re,S as ie,l as ce,Q as pe}from"./ui-vendor-D13i6_Ys.js";import{S as de}from"./Search-ByXbnNmZ.js";import{C as ue,E as me}from"./EditOutlined-DLIgbPlx.js";import{b as fe}from"./index-DqO_OEbo.js";import"./utils-vendor-lGwZSMVs.js";const _e={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},z=F({name:"Close",render:function(k,g){return d(),p("svg",_e,g[0]||(g[0]=[r("path",{d:"M289.94 256l95-95A24 24 0 0 0 351 127l-95 95l-95-95a24 24 0 0 0-34 34l95 95l-95 95a24 24 0 1 0 34 34l95-95l95 95a24 24 0 0 0 34-34z",fill:"currentColor"},null,-1)]))}}),he={class:"absolute top-0 left-0 w-280px h-full px-3 flex flex-col"},ve={class:"flex-none h-16 flex items-center justify-between"},ge={class:"flex items-center gap-2"},xe={class:"text-base font-medium text-gray-800 dark:text-gray-200"},ye={class:"flex items-center gap-2"},we={key:0,class:"flex-1 overflow-auto pt-4"},be={class:"flex gap-2 mt-4"},ke={class:"w-full flex py-2 pt-4 items-center overflow-hidden"},Pe={class:"flex-1 overflow-hidden"},Ce={key:0,class:"flex flex-col items-center justify-center h-[calc(100vh-280px)]"},$e={class:"text-5xl text-gray-300 mb-2"},Se={key:1,class:"space-y-3 py-2"},Ie=["onClick"],Le={class:"text-sm font-medium dark:text-gray-200 text-gray-800 mb-1"},Be={class:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2"},ze={class:"absolute right-2 top-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},Fe=F({__name:"prompt",emits:["selectPrompt"],setup(R,{emit:k}){const g=k,P=oe(),C=h(null),f=h(!1),l=Z(),$=W(()=>l.searchPromptList.length>0?l.searchPromptList:l.promptList);G(()=>l.promptList,t=>{l.searchPromptList=t},{immediate:!0});const N={title:{required:!0,message:"标题必填",trigger:"blur"},content:{required:!0,message:"内容必填",trigger:"blur"}},S={promptId:"",title:"",content:""},i=h(S),D=h(null),v=h(""),_=h(!1);H(async()=>{await l.getPromptList(),l.searchPromptList=l.promptList});function E(){i.value={...S},f.value=!f.value}function U(){f.value=!1}function V(t){l.prompt=t.content,g("selectPrompt",t)}function j(t){t.preventDefault();const a=P.loading("处理中",{duration:0});C.value?.validate(async u=>{if(u)return P.error("验证不通过");try{i.value.promptId?await ee({...i.value}):await te({...i.value,promptId:void 0}),f.value=!1,await l.getPromptList(),a.destroy()}catch(c){console.error(c)}})}function q(t,a){a?.stopPropagation(),i.value={promptId:t.promptId,title:t.title,content:t.content},f.value=!0}function A(t,a){a?.stopPropagation(),l.removePrompt(t)}function I(){l.searchPrompts(v.value)}function K(){v.value||(_.value=!1,l.searchPrompts(""))}return(t,a)=>{const u=ae,c=se,w=re,L=ne,M=le,O=ce,T=pe,Q=ie;return d(),p("div",{class:b(["prompt-sidebar relative z-10 h-full shadow-lg overflow-hidden",[o(l).showPromptSidebar?"w-280px":"w-0"]])},[r("div",he,[r("div",ve,[r("div",ge,[r("span",xe,m(t.$t("chat.promptCenter")),1)]),r("div",ye,[e(c,{quaternary:"",circle:"",size:"small",class:"hover:text-error transition-colors",onClick:a[0]||(a[0]=n=>o(l).showPromptSidebar=!1)},{icon:s(()=>[e(u,null,{default:s(()=>[e(o(z))]),_:1})]),_:1})])]),o(f)?(d(),p("div",we,[e(M,{ref_key:"promptFormRef",ref:C,"label-width":"auto",model:o(i),rules:N,class:"animate-fade-in"},{default:s(()=>[e(L,{path:"title",label:t.$t("common.title")},{default:s(()=>[e(w,{value:o(i).title,"onUpdate:value":a[1]||(a[1]=n=>o(i).title=n),placeholder:t.$t("chat.promptTitle"),class:"rounded-lg shadow-sm"},null,8,["value","placeholder"])]),_:1},8,["label"]),e(L,{path:"content",label:t.$t("common.content")},{default:s(()=>[e(w,{value:o(i).content,"onUpdate:value":a[2]||(a[2]=n=>o(i).content=n),type:"textarea",placeholder:t.$t("chat.promptContent"),class:"rounded-lg shadow-sm"},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"]),r("div",be,[e(c,{class:"flex-1 rounded-lg",onClick:U},{default:s(()=>[y(m(t.$t("common.cancel")),1)]),_:1}),e(c,{type:"primary",class:"flex-1 rounded-lg",onClick:j},{default:s(()=>[y(m(t.$t("common.save")),1)]),_:1})])])):(d(),p(B,{key:1},[r("div",ke,[e(c,{type:"primary",size:"small",class:b(["flex-1 px-6 rounded-lg transition-all duration-300 hover:opacity-90 mr-2",{"-ml-full":o(_),"ml-0":!o(_)}]),onClick:E},{default:s(()=>[y(m(t.$t("chat.createPrompt")),1)]),_:1},8,["class"]),e(w,{ref_key:"searchInputRef",ref:D,value:o(v),"onUpdate:value":a[3]||(a[3]=n=>Y(v)?v.value=n:null),type:"text",size:"small",placeholder:"搜索提示词",class:b(["search-input transition-width duration-300 rounded-lg cursor-pointer",{"w-full!":o(_),"w-36px!":!o(_)}]),onFocus:a[4]||(a[4]=n=>_.value=!0),onBlur:K,onKeyup:I,onKeydown:X(I,["enter"])},{prefix:s(()=>[e(u,null,{default:s(()=>[e(o(de))]),_:1})]),_:1},8,["value","class"])]),r("div",Pe,[e(Q,{class:"h-full"},{default:s(()=>[o($).length?(d(),p("div",Se,[(d(!0),p(B,null,J(o($),n=>(d(),p("div",{key:n.promptId,class:"group relative bg-white dark:bg-dark-800 rounded-lg border border-gray-100 dark:border-dark-700 hover:border-primary transition-all duration-300 cursor-pointer"},[r("div",{class:"w-full p-3",onClick:x=>V(n)},[r("div",Le,m(n.title),1),r("p",Be,m(n.content),1)],8,Ie),r("div",ze,[e(c,{text:"",size:"small",onClick:x=>q(n,x)},{icon:s(()=>[e(u,{class:"text-gray-600 hover:text-primary"},{default:s(()=>[e(o(me))]),_:1})]),_:2},1032,["onClick"]),e(T,{placement:"top",onPositiveClick:x=>A(n.promptId,x)},{trigger:s(()=>[e(c,{text:"",size:"small"},{icon:s(()=>[e(u,{class:"text-gray-600 hover:text-red-500"},{default:s(()=>[e(o(z))]),_:1})]),_:1})]),default:s(()=>[y(" "+m(t.$t("chat.removeConfirm")),1)]),_:2},1032,["onPositiveClick"])])]))),128))])):(d(),p("div",Ce,[e(O,{class:"animate-fade-in",description:t.$t("chat.noPrompts")},{icon:s(()=>[r("div",$e,[e(u,null,{default:s(()=>[e(o(ue))]),_:1})])]),_:1},8,["description"])]))]),_:1})])],64))])],2)}}}),qe=fe(Fe,[["__scopeId","data-v-663b8412"]]);export{qe as default};
